"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5774],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),m=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=m(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=m(n),u=r,f=d["".concat(l,".").concat(u)]||d[u]||p[u]||o;return n?a.createElement(f,i(i({ref:t},c),{},{components:n})):a.createElement(f,i({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var m=2;m<o;m++)i[m]=n[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8327:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return p}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={sidebar_position:3,title:"Custom Data Format"},l=void 0,m={unversionedId:"getting-started/customizing-things/custom-data-format",id:"getting-started/customizing-things/custom-data-format",title:"Custom Data Format",description:"By default, classy only supports .tsv and .jsonl files. However, you can easily add support for your own file format on some task.",source:"@site/docs/getting-started/customizing-things/custom-data-format.md",sourceDirName:"getting-started/customizing-things",slug:"/getting-started/customizing-things/custom-data-format",permalink:"/classy/docs/getting-started/customizing-things/custom-data-format",editUrl:"https://github.com/sunglasses-ai/classy/edit/main/docs/docs/getting-started/customizing-things/custom-data-format.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Custom Data Format"},sidebar:"tutorialSidebar",previous:{title:"Changing Profile",permalink:"/classy/docs/getting-started/customizing-things/changing-profile"},next:{title:"Custom Model",permalink:"/classy/docs/getting-started/customizing-things/custom-model"}},c={},p=[{value:"A Minimal Example",id:"a-minimal-example",level:2}],d={toc:p};function u(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"By default, classy only supports .tsv and .jsonl files. However, you can easily add support for your own file format on some task.\nYou just need to implement your own data driver and register it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"# implement your data driver\n@DataDriver.register(YOUR_TASK, YOUR_FILE_EXTENSION)\nclass CustomDataDriver(DataDriver):\n    def read(self, lines: Iterator[str]) -> Iterator[ClassySample]:\n        raise NotImplementedError\n\n    def save(\n        self,\n        samples: Iterator[ClassySample],\n        path: str,\n        use_predicted_annotation: bool = False,\n    ):\n        raise NotImplementedError\n")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"classy")," uses the tuple (task, file-extension) to determine the data driver to instantiate for some file. This means that\npostpending file extensions is mandatory, even on Unix systems."))),(0,o.kt)("h2",{id:"a-minimal-example"},"A Minimal Example"),(0,o.kt)("p",null,"For instance, imagine you were to reimplement the ",(0,o.kt)("inlineCode",{parentName:"p"},".jsonl")," data driver for Sequence Classification:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'@DataDriver.register(SEQUENCE, "jsonl")\nclass JSONLSequenceDataDriver(SequenceDataDriver):\n    pass\n')),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"SequenceDataDriver is just a subclass of DataDriver where the sample types have been downcasted to SequenceSample only."))),(0,o.kt)("p",null,"You would first implement the read method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"def read(self, lines: Iterator[str]) -> Iterator[SequenceSample]:\n    # iterate on lines\n    for line in lines:\n        # read json object and instantiate sequence sample\n        yield SequenceSample(**json.loads(line))\n")),(0,o.kt)("p",null,"and, then, the save method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def save(self, samples: Iterator[SequenceSample], path: str):\n    with open(path, "w") as f:\n        # iterate on samples\n        for sample in samples:\n            # dump json object\n            f.write(\n                json.dumps(\n                    {"sequence": sample.sequence, "label": sample.reference_annotation}\n                )\n                + "\\n"\n            )\n')),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"While both ",(0,o.kt)("inlineCode",{parentName:"p"},".jsonl")," and ",(0,o.kt)("inlineCode",{parentName:"p"},".tsv")," are one-sample-per-line formats, your own data driver does not need to follow this behavior. As you\nhave access to the lines iterator, you can read your file as you see fit."))))}u.isMDXComponent=!0}}]);